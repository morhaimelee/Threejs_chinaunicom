<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>省分大楼</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      /* 隐藏body窗口区域滚动条 */
      /* background-image: linear-gradient(rgb(46,81,255), #000); */
    }

    /* #cc {
      background-image: linear-gradient(rgb(46,81,255), #000);
    } */
    /* .label {
      width: 100px;
      height: 50px;
      color: #FFF;
      font-family: sans-serif;
      padding: 2px;
      background: rgb(87, 179, 248);
      opacity: .7;
      text-align: center;
      cursor: pointer;
      position: absolute;
      top: 500px;
      line-height: 50px;
    } */
    #progress {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      margin: 0;
      font-size: 40px;
      line-height: 1080px;
      font-weight: bold;
      color: #fff;
      text-align: center;
      background-color: #4d5aaf;
      z-index: 1000;
    }

    .moveDiv {
      width: 150px;
      height: 100px;
      color: #fff;
      background: rgb(87, 179, 248, 0.6);
      text-align: center;
      position: absolute;
      top: 300px;
      line-height: 100px;
      cursor: pointer;
    }

    #bianjie {
      position: absolute;
      top: 0;
      left: 30%;
      width: 100px;
      height: 20px;
      color: #fff;
    }

    .testDiv {
      position: absolute;
      padding: 10px;
      background: rgba(255, 255, 255, 0.6);
      line-height: 1;
      border-radius: 5px;
    }

    .videoIcon {
      width: 18.5px;
      height: 23.5px;
      position: absolute;
      background: url('./assets/imgs/shexiangtou.png') center center no-repeat;
      background-size: 100% auto;
      display: none;
      cursor: pointer;
    }

    .waterIcon {
      width: 18.5px;
      height: 23.5px;
      position: absolute;
      background: url('./assets/imgs/水箱.png') center center no-repeat;
      background-size: 100% auto;
      cursor: pointer;
      display: none;
    }


    .gateIcon {
      width: 18.5px;
      height: 23.5px;
      position: absolute;
      background: url('./assets/imgs/zhaji.png') center center no-repeat;
      background-size: 100% auto;
      cursor: pointer;
      display: none;
    }

    .smokeIcon {
      width: 18.5px;
      height: 23.5px;
      position: absolute;
      background: url('./assets/imgs/yangan.png') center center no-repeat;
      background-size: 100% auto;
      cursor: pointer;
      display: none;
    }

    .videoLayer {
      width: 185px;
      height: 104px;
      position: absolute;
      border: 1px solid #fff;
      display: none;
    }

    .tankLayer {
      width: 185px;
      height: 104px;
      position: absolute;
      border: 1px solid #4DFFFF;
      background: rgba(0, 0, 0, .6);
      text-align: center;
      line-height: 104px;
      font-size: 16px;
      color: #fff;
      display: none;
    }

    .smokeLayer {
      width: 185px;
      height: 104px;
      position: absolute;
      text-align: center;
      background: rgba(0, 0, 0, .6);
      color: #fff;
      border: 1px solid #4DFFFF;
      line-height: 104px;
      font-size: 16px;
      display: none;
    }

    #camera_position {
      width: 100px;
      height: 100px;
      position: absolute;
      left: 100px;
      bottom: 200px;
      color: #fff;
      background: aqua;
    }
  </style>
  <link rel="stylesheet" href="./css/index_new.css" />
  <script src="https://cdn.staticfile.org/jquery/3.5.0/jquery.min.js"></script>
  <!--引入three.js三维引擎-->
  <script src="./js/three.js"></script>
  <!-- 引入threejs扩展控件OrbitControls.js -->
  <script src="./js/OrbitControls.js"></script>
  <!-- 引入gltf -->
  <script src="./js/GLTFLoader.js"></script>
  <!-- dracoLoader -->
  <script src="./js/DRACOLoader.js"></script>
  <script src="./js/Draco/draco_decoder.js"></script>
  <!-- obj -->
  <!-- <script src="./js/OBJLoader.js"></script>
  <script src="./js/MTLLoader.js"></script> -->
  <!-- fps查看 -->
  <script src="./js/stats.min.js"></script>
  <!--加载控制器-->
  <script src="./js/TrackballControls.js"></script>
  <!-- 2D渲染器 -->
  <script src="./js/CSS2DRenderer.js"></script>
  <!--加载缓动插件-->
  <script src="./js/TweenMax.min.js"></script>
  <!-- 数据加载 -->
  <script src="./js/template-web.js"></script>
  <!-- m3u8 -->

  <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet">
  <script src='https://vjs.zencdn.net/7.4.1/video.js'></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.min.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script> -->
</head>

<body onload="draw();">
  <!-- <div class="moveDiv">点击移动</div> -->
  <!-- <div id="bianjie">便捷通行</div> -->
  <div class="testDiv"></div>
  <canvas id="cc"></canvas>
  <div id="progress"></div>
  <div class="topleft"></div>
  <nav class="nav">
    <ul>
      <li class="nav_list fl selected" id="equipment_warning">设备警告</li>
      <li class="nav_list fl" id="personnel_management">人员管理</li>
      <li class="nav_list fl" id="public_resource">公共资源</li>
      <li class="nav_list fl" id="environmental_management">环境管理</li>
      <!-- <li class="nav_list fl">办公运营</li> -->
    </ul>
  </nav>

  <!-- 左侧设备菜单 -->
  <div class="equipment-list">
    <ul>
      <li id="video_list" class="video_list"></li>
      <li id="waterTank_list" class="waterTank_list"></li>
      <!-- <li id="fire_list" class="fire_list"></li> -->
      <li id="smoke_list" class="smoke_list"></li>
      <li id="gate_list" class="gate_list"></li>
      <li id="trashCan_list" class="trashCan_list"></li>
      <li id="hole_cover_list" class="hole_cover_list"></li>
      <!-- <li id="park_list"></li> -->
      <li id="AOCN_list" class="AOCN_list"></li>
      <li id="meter_list" class="meter_list"></li>
    </ul>
  </div>
  <!-- 右上时间&天气 -->
  <section class="time-date">
    <div id="time"></div>
    <div id="date"></div>
    <div id="vertical_bar"></div>
    <div id="weather"></div>
    <div id="temperature"></div>
  </section>
  <section id="first_page" class="all_of_page">
    <!-- 监控设备运行录像 -->
    <div class="warnVideo-title">
      <i></i>
      <span>监控设备运行</span>
      <div>Monitoring equipment</div>
    </div>

    <!-- 随机影像 -->
    <div id="random-video">
      <!-- video -->
      <video id="welcomeVideo" class="video-js vjs-default-skin" controls preload="auto" muted data-setup='{}'
        style='width: 100%;height: 100%'>

      </video>
    </div>
    <div id="equip-num">
      <div>设备名称</div>
      <div id="equip_name">8T242</div>
    </div>
    <div id="equip-allnum">
      <i></i>
      <span class="point-yellow"></span>
      <span>设备总数量</span>
      <span id="equip_num"></span>&nbsp;个
    </div>

    <!-- 设备数量细则 -->
    <div class="equip-list">
      <ol>
        <li><span class="point-yellow"></span> 运行数量</li>
        <li><span class="point-blue"></span> 离线数量</li>
        <li><span class="point-red"></span> 告警数量</li>
      </ol>
      <ul>
        <li><i></i><span id="onlineNum"></span></li>
        <li><i></i><span id="offlineNum"></span></li>
        <li><i></i><span id="repairNum"></span></li>
      </ul>
    </div>

    <section class="equip-online">
      <div class="warnVideo-title">
        <i></i>
        <span>设备在线情况</span>
        <div>Equipment online</div>
      </div>
      <div id="echarts_first_leftBottom"></div>
    </section>

    <!-- 越界告警 -->
    <section class="cross-border-alarm">
      <div class="warnVideo-title">
        <i></i>
        <span>越界告警</span>
        <div>Cross-border alarm</div>
      </div>
    </section>
    <div class="visitors-box" id="cross_box">

    </div>

    <script id="cross_temp" type="text/html">
      <div class="visitor-realTime-data">
        {{each outofAlarm}}
        <div class="realTime-box">
          <ul>
            
            <li><img src="{{$value.alarmPic}}" alt=""></li>
            <li>告警原因：{{$value.reason}}</li>
            <li>处理情况：{{$value.handlerStatus}}</li>
            <li>告警地点：B栋一楼</li>
            <li>{{$value.alarmTime}}</li>
          </ul>
        </div>
        {{/each}}
      </div>
    
    </script>

    <!-- 安防告警 -->
    <section class="Security-alarm">
      <div class="warnVideo-title">
        <i></i>
        <span>安防告警</span>
        <div>Security alarm</div>
      </div>
      <div class="alarm-all-num-box">
        <ol>
          <li>告 警 总 数</li>
          <li>未 处 理</li>
          <li>已 处 理</li>
        </ol>
        <ul>
          <li id="securityAlarm_totle"></li>
          <li id="securityAlarm_unHandlerNum"></li>
          <li id="securityAlarm_handlerNum"></li>
        </ul>
      </div>

    </section>
    <!-- 设备状态异常滚动 -->
    <div class="equip-status-box">
      <ol>
        <li>设备</li>
        <li style="margin-left: 25px;">告警内容</li>
        <li>告警时间</li>
        <li>状态</li>
      </ol>
      <div id="mid-line"></div>
      <div id="warn_list">
        <script id="warn_list_temp" type="text/html">
          <ul>
            {{each security}}
            <li>
              <span>{{$value.devName}}</span>
              <span>{{$value.repairDesc}}</span>
              <span>{{$value.alarmTime}}</span>
              {{if $value.handlerStatus == "已处理"}}<span class="color-deal">{{$value.handlerStatus}}</span>{{else if $value.handlerStatus == "未处理"}}<span class="color-deal color-deal-red">{{$value.handlerStatus}}</span>{{/if}}
            </li>
            {{/each}}
          </ul>
        </script>
      </div>
    </div>
    <!-- 近三个月告警趋势 -->
    <section class="recent-trends">
      <div class="warnVideo-title">
        <i></i>
        <span>近3个月告警趋势</span>
        <div>Recent trends</div>
      </div>

    </section>
    <div id="echarts_first_rightBottom"></div>
  </section>
  <!-- 人员管理页签 -->
  <section id="second_page" class="all_of_page">
    <!-- 楼层总人数 -->
    <section class="total_number_of_floor">
      <div class="warnVideo-title">
        <i></i>
        <span>楼层总人数</span>
        <div>Security alarm</div>
      </div>
    </section>
    <div id="echarts_second_leftTop"></div>

    <!-- 今日人流量各时段统计 -->
    <section class="todays_statistics">
      <div class="warnVideo-title">
        <i></i>
        <span>今日人流量各时段统计</span>
        <div>Today's traffic statistics for each period</div>
      </div>
    </section>
    <div id="echarts_second_leftBottom"></div>

    <!-- 人员状况 -->
    <section class="people-status">
      <div class="warnVideo-title">
        <i></i>
        <span>人员状况</span>
        <div>People status</div>
      </div>
    </section>

    <div class="company-all-person-num">
      <div class="company-person">
        <span>公司员工 <div id="company_person">
            <ul class="person-single-num">
              <li>0</li>
              <li>6</li>
              <li>4</li>
              <li>2</li>
            </ul>
          </div>人
        </span>
      </div>
      <div class="visitor-person">
        <span>访客人员 <div id="visitor_person">
            <ul class="person-single-num">
              <li>0</li>
              <li>0</li>
              <li>1</li>
              <li>2</li>
            </ul>
          </div>人
        </span>
      </div>
    </div>


    <!-- <script id="tmpl" type="text/html"></script> -->

    <!-- 访客进入实时数据 -->
    <section class="visitor-real-data">
      <div class="warnVideo-title">
        <i></i>
        <span>访客进入实时数据</span>
        <div>Visitors enter real-time data</div>
      </div>
    </section>
    <div class="visitor-realTime-data">
      <div class="realTime-box">
        <ul>
          <li><img src="./assets/imgs/QQtouxiang.png" alt=""></li>
          <li>姓名： 某某某</li>
          <li>通过门禁： B栋一楼</li>
          <li>进入时间： 2020-7-22</li>
        </ul>
      </div>
      <div class="realTime-box">
        <ul>
          <li><img src="./assets/imgs/QQtouxiang.png" alt=""></li>
          <li>姓名： 某某某</li>
          <li>通过门禁： B栋一楼</li>
          <li>进入时间： 2020-7-22</li>
        </ul>
      </div>
      <div class="realTime-box">
        <ul>
          <li><img src="./assets/imgs/QQtouxiang.png" alt=""></li>
          <li>姓名： 某某某</li>
          <li>通过门禁： B栋一楼</li>
          <li>进入时间： 2020-7-22</li>
        </ul>
      </div>
    </div>

    <!-- 访客实时数据 -->
    <section class="visitor-real-time-data">
      <div class="warnVideo-title">
        <i></i>
        <span>访客实时数据</span>
        <div>Visitor real-time data</div>
      </div>
    </section>
    <div class="visitor-sys">
      <ol>
        <li>今日访客</li>
        <li>当前访客</li>
        <li>未到访客</li>
      </ol>
      <ul>
        <li>200</li>
        <li>50</li>
        <li>10</li>
      </ul>
    </div>
    <!-- 访客list -->
    <div class="visitor-list">
      <ol>
        <li class="fl">访客姓名</li>
        <li class="fl">受访人</li>
        <li class="fl">预约时间</li>
        <li class="fl">状态</li>
      </ol>
      <div class="line-gray"></div>
      <ul>
        <li><span>某某某</span><span>某某某</span><span>07-22 16:14</span><span>已进入</span></li>
        <li><span>某某某</span><span>某某某</span><span>07-22 16:14</span><span>已进入</span></li>
        <li><span>某某某</span><span>某某某</span><span>07-22 16:14</span><span>已进入</span></li>
        <li><span>某某某</span><span>某某某</span><span>07-22 16:14</span><span>已进入</span></li>
      </ul>
    </div>

  </section>



  <!-- 公共资源页签 -->
  <section id="thrid_page" class="all_of_page">
    <!-- 车位占比 -->
    <section class="percentage-parking-spaces">
      <div class="warnVideo-title">
        <i></i>
        <span>车位占比</span>
        <div>Percentage of parking spaces</div>
      </div>
    </section>
    <div id="echarts_third_leftTop"></div>

    <!-- 车辆类型 -->
    <section class="vehicle-Type">
      <div class="warnVideo-title">
        <i></i>
        <span>车辆类型</span>
        <div>Vehicle Type</div>
      </div>
    </section>
    <div id="echarts_third_leftMid"></div>
    <div class="car-chart">
      <ul>
        <li class="fl">长期车</li>
        <li class="fl">预约车</li>
        <li class="fl">临时车</li>
      </ul>
    </div>
    <!-- 车辆进出记录 -->
    <section class="Vehicle-records">
      <div class="warnVideo-title">
        <i></i>
        <span>车辆进出记录</span>
        <div>Vehicle entry and exit records</div>
      </div>
      <div class="legend">
        <i class="enter_go"></i><span>进</span>
        <i class="enter_go go_icon"></i><span>出</span>
      </div>
    </section>
    <div class="records-list" id="records_list">
      <script id="records_temp" type="text/html">
        <ul>
          {{each record}}
          <li>
            {{if $value.type == "in"}}
            <i class="enter_go"></i>
            {{else if $value.type == "out"}}
            <i class="enter_go go_icon"></i>
            {{/if}}
            <div class="line-list"></div>
            <span>{{$value.carCode}}</span>
            <div class="time-box">{{$value.recordTime}}</div>
          </li>
          {{/each}}
        </ul>
      </script>

    </div>
    <!-- 停车场占用率 -->
    <section class="parking_rate">
      <div class="warnVideo-title">
        <i></i>
        <span>停车场占用率</span>
        <div>Parking lot occupancy rate</div>
      </div>
    </section>
    <div id="echarts_third_rightTop"></div>
    <!-- 会议室使用情况 -->
    <section class="conference_room">
      <div class="warnVideo-title">
        <i></i>
        <span>会议室使用情况</span>
        <div>Conference room usage</div>
      </div>
    </section>
    <div class="conference-room-box">
      <ol>
        <li><i></i>可预约</li>
        <li><i></i>不可预约</li>
        <li><i></i>待开放</li>
      </ol>
      <ul>
        <li class="fl">
          <div>A601</div>
        </li>
        <li class="fl">
          <div>B601</div>
        </li>
        <li class="fl">
          <div>A602</div>
        </li>
        <li class="fl">
          <div>B602</div>
        </li>
        <li class="fl">
          <div>A603</div>
        </li>
        <li class="fl">
          <div></div>
        </li>
      </ul>
      <ul>
        <li class="fl">
          <div>A604</div>
        </li>
        <li class="fl">
          <div class="yuyue">B604</div>
        </li>
        <li class="fl">
          <div>A605</div>
        </li>
        <li class="fl">
          <div>B605</div>
        </li>
        <li class="fl">
          <div>A606</div>
        </li>
        <li class="fl">
          <div></div>
        </li>
      </ul>
      <ul>
        <li class="fl">
          <div>A607</div>
        </li>
        <li class="fl">
          <div>B607</div>
        </li>
        <li class="fl">
          <div>A809</div>
        </li>
        <li class="fl">
          <div>A903</div>
        </li>
        <li class="fl">
          <div class="un-yuyue">B405</div>
        </li>
        <li class="fl">
          <div></div>
        </li>
      </ul>
      <ul>
        <li class="fl">
          <div>B603</div>
        </li>
        <li class="fl">
          <div>B606</div>
        </li>

      </ul>
    </div>

  </section>



  <section id="fourth_page" class="all_of_page">
    <!-- 环境监测 -->
    <section class="environmental-monitoring">
      <div class="warnVideo-title">
        <i></i>
        <span>环境监测</span>
        <div>Environmental monitoring</div>
      </div>
    </section>
    <section class="environmental-box">
      <ul>
        <li class="fl">空气指数：<span>38 优</span></li>
        <li class="fl">PM10：<span>38</span></li>
        <li class="fl clearfix">风向：<span> 东北风 3-14级</span></li>
      </ul>
      <ul>
        <li class="fl">PM2.5 ：<span> 16</span></li>
        <li class="fl">CO ：<span> 16</span></li>
        <li class="fl">湿度：<span> 43%</span></li>
      </ul>
    </section>
    <!-- 设备信息 -->
    <section class="device-information">
      <div class="warnVideo-title">
        <i></i>
        <span>设备信息</span>
        <div>Device Information</div>
      </div>
    </section>
    <section class="device-box">
      <div class="option">
        <select>
          <option class="option-class" value="1">垃圾桶</option>
          <option class="option-class" value="2">井盖</option>
        </select>
      </div>
      <div class="device-list-box">
        <ul>
          <li>
            <div class="device-div"><span class="device-name">井盖（E- 2515） </span> <span class="fr">异常</span></div>
            <div class="divice-31"><span class="blue-82">电流</span><span class="white-33">2.2A</span><span
                class="blue-82">上传时间</span><span class="last_white">2020-7-22 14:33</span></div>
            <div class="divice-31"><span class="blue-82">状态说明</span><span class="white-33">正常</span><span
                class="blue-82">地址</span><span class="last_white">林城东路109号大楼</span></div>
          </li>
          <li>
            <div class="device-div"><span class="device-name">井盖（E- 2515） </span> <span class="fr">异常</span></div>
            <div class="divice-31"><span class="blue-82">电流</span><span class="white-33">2.2A</span><span
                class="blue-82">上传时间</span><span class="last_white">2020-7-22 14:33</span></div>
            <div class="divice-31"><span class="blue-82">状态说明</span><span class="white-33">正常</span><span
                class="blue-82">地址</span><span class="last_white">林城东路109号大楼</span></div>
          </li>
          <li>
            <div class="device-div"><span class="device-name">井盖（E- 2515） </span> <span class="fr">异常</span></div>
            <div class="divice-31"><span class="blue-82">电流</span><span class="white-33">2.2A</span><span
                class="blue-82">上传时间</span><span class="last_white">2020-7-22 14:33</span></div>
            <div class="divice-31"><span class="blue-82">状态说明</span><span class="white-33">正常</span><span
                class="blue-82">地址</span><span class="last_white">林城东路109号大楼</span></div>
          </li>
          <li>
            <div class="device-div"><span class="device-name">井盖（E- 2515） </span> <span class="fr">异常</span></div>
            <div class="divice-31"><span class="blue-82">电流</span><span class="white-33">2.2A</span><span
                class="blue-82">上传时间</span><span class="last_white">2020-7-22 14:33</span></div>
            <div class="divice-31"><span class="blue-82">状态说明</span><span class="white-33">正常</span><span
                class="blue-82">地址</span><span class="last_white">林城东路109号大楼</span></div>
          </li>
        </ul>
      </div>
    </section>
    <!-- 耗能总量 -->
    <section class="energy-consumption">
      <div class="warnVideo-title">
        <i></i>
        <span>耗能总量</span>
        <div>Total energy consumption</div>
      </div>
    </section>
    <div class="energy-logo">
      <div><i class="dian"></i></div>
      <div><i class="shui"></i></div>
    </div>
    <div class="energy-num"><span id="dian_num">12546.9</span>kw</div>
    <div class="energy-num energy-num2"><span id="shui_num">12546.9</span>t</div>
    <div class="total-dian-text">累计耗电总量</div>
    <div class="total-shui-text">累计耗水总量</div>
    <!-- 当日能耗趋势 -->
    <section class="day-energy">
      <div class="warnVideo-title">
        <i></i>
        <span>当日能耗趋势</span>
        <div>Energy consumption trend of the day</div>
      </div>
    </section>
    <div id="echarts_fourth_rightTop"></div>
    <!-- 设备耗电占比 -->
    <section class="equipment-power">
      <div class="warnVideo-title">
        <i></i>
        <span>设备耗电占比</span>
        <div>Percentage of equipment power consumption</div>
      </div>
    </section>
    <div id="echarts_fourth_rightBottom"></div>

  </section>
  <!-- <div class="btn_left" id="people_moni">安防监控</div> -->
  <div class="btn_left" id="in_ex_floor">进入大楼</div>

  <!--  value="play()" -->
  <!-- <div class="btn_left" id="gate">闸机</div>
  <div class="btn_left" id="smoke">烟感</div>
  <div class="btn_left" id="fire_waterP">消防水压</div>
  <div class="btn_left" id="line_temp">线缆温度</div> -->
  <div class="btn_left" id="back_all">返回主场景</div>

  <div id="bottomFloor">
    <ul>
      <li class="fl" id="f1">F1</li>
      <li class="fl" id="f2">F2</li>
      <li class="fl" id="f3">F3</li>
      <li class="fl" id="f4">F4</li>
      <li class="fl" id="f5">F5</li>
      <li class="fl" id="f6">F6</li>
      <li class="fl" id="f7">F7</li>
      <li class="fl" id="f8">F8</li>
      <li class="fl" id="f9">F9</li>
    </ul>
  </div>

  <!-- <div id="camera_position">相机位置</div> -->
  <script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.js"></script>
  <script src="./js/GetTime.js"></script>
  <script src="./js/weather.js"></script>
  <script src="./js/button.js"></script><!-- 按钮js -->
  <script src="./js/ajax.js"></script>
  <!-- <script src="./js/echarts-main.js"></script> -->
  <script>


    echarts.init(document.getElementById('echarts_second_leftTop')).setOption(option1_second); //二页左上角echarts
    echarts.init(document.getElementById('echarts_second_leftBottom')).setOption(option2_second); //二页左上角echarts

    echarts.init(document.getElementById('echarts_third_leftMid')).setOption(option2_third); //三页中echarts
    echarts.init(document.getElementById('echarts_third_rightTop')).setOption(option3_third); //三页右上echarts
    echarts.init(document.getElementById('echarts_fourth_rightTop')).setOption(option1_fourth); //四页右上echarts
    echarts.init(document.getElementById('echarts_fourth_rightBottom')).setOption(option2_fourth); //四页右下echarts

    let objAll = null
    let container, stats, controls

    let camera,
      scene,
      renderer,
      light,
      point,
      point3,
      directionalLight,
      directionalLight2,
      ambient

    let model

    var mesh, mixer, action;

    let Vplace1 = []
    let Vplace2 = []
    let width, height, k, s

    let GLTFLoader_AllBuild,
      GLTFLoader_otherBuild

    let model_video1, model_video2, model_video3, model_video4, model_video5

    let model_all = [] //所有模型
    let model_all_floor1 = [] //每层所有模型
    let model_all_floor2 = []
    let model_all_floor3 = []
    let model_all_floor4 = []
    let model_all_floor5 = []
    let model_all_floor6 = []
    let model_all_floor7 = []
    let model_all_floor8 = []
    let model_all_floor9 = []
    let model_all_floorB1 = []
    //创建控件对象  相机对象camera作为参数   控件可以监听鼠标的变化，改变相机对象的属性
    // controls = new THREE.OrbitControls(camera, renderer.domElement);

    function initStats() {
      stats = new Stats()
      document.body.appendChild(stats.dom)
    }

    function init() {
      renderer = new THREE.WebGLRenderer({
        antialias: true,
        canvas: document.querySelector('#cc'),
      })
      renderer.setPixelRatio(window.devicePixelRatio)
      renderer.setSize(window.innerWidth, window.innerHeight)
      renderer.shadowMap.enabled = true //渲染器接收阴影渲染

      renderer.setClearColor('rgb(0,47,94)', 1) //背景颜色像素及渲染
      // renderer.setClearColor('rgb(76,76,88)', 1) //背景颜色像素及渲染
      // renderer.setClearColor('rgb(0,16,32)', 1)//进入楼层后更改

      // renderer.setClearColor('linear-gradient(rgb(46,81,255), #000)', 1.0);
      // renderer.setClearColor('rgba(135,206,250,0.5)',1.0);

      window.addEventListener('resize', onWindowResize, false) //窗口大小变化后，针对当前窗口大小比例渲染

      /**
       * 相机设置
       */
      width = window.innerWidth //窗口宽度
      height = window.innerHeight //窗口高度
      k = width / height //窗口宽
      // s = 300; //三维场景显示范围控制系数，系数越大，显示的范围越大
      // s = 250
      //创建相机对象
      // camera = new THREE.OrthographicCamera(-s * k, s * k, s, -s, 1, 2000);
      camera = new THREE.PerspectiveCamera(45, width / height, 1, 2000)
      camera.position.set(13.6, 10, 31.3) //设置相机位置
      // camera.position.set(10, 30, 100) //设置相机位置
      // camera.position.set(1000, 1000, 2000); //设置相机位置
      // camera.position.z = 2000

      // //监听鼠标事件，触发渲染函数，更新canvas画布渲染效果
      controls = new THREE.OrbitControls(
        camera,
        document.querySelector('#cc'),
      ) //添加控制器 //设置控制器。方便操控3d世界。
      // controls.target.set(0, 0, 0); //设置控制器控制中心点
      // controls.update(); //控制器更新
      //设置相机距离原点的最远距离`````````
      controls.minDistance = 1
      //设置相机距离原点的最远距离
      controls.maxDistance = 2000

      scene = new THREE.Scene() //创建场景
      scene.name = 'WEB_Scene'
      // camera.lookAt(scene.position); //设置相机方向(指向的场景对象)

      //增加背景图
      //   var loader = new THREE.TextureLoader();
      //   var backgroundTexture = loader.load( './assets/background/background.png');
      //   scene.background = backgroundTexture;

      // 模拟坐标轴
      var axesHelper = new THREE.AxesHelper(100)
      // scene.add(axesHelper)
      /**
       * 光源设置
       */
      //点光源
      point = new THREE.PointLight(0xffffff, 0.1)
      point.position.set(1.763, 5.099, -0.190) //点光源中间

      // scene.add(point) //点光源添加到场景中
      // var point2 = new THREE.PointLight(0x72b1ff);
      // point2.position.set(-554.418, 337.135, -20.433); //点光源左侧
      // scene.add(point2); //点光源添加到场景中
      // point3 = new THREE.PointLight(0x72b1ff);
      // point3.position.set(463.018, 278.976, -21.585); //点光源右侧
      // scene.add(point3); //点光源添加到场景中
      // var point4 = new THREE.PointLight(0x72b1ff);
      // point4.position.set(136.340, 336.995, -438.744); //点光源后侧
      // scene.add(point4); //点光源添加到场景中
      // var point5 = new THREE.PointLight(0x72b1ff);
      // point5.position.set(-52.809, 385.392, 610.896); //左圈
      // scene.add(point5); //点光源添加到场景中

      //平行光
      directionalLight = new THREE.DirectionalLight(0xffffff, 2.5)
      directionalLight.name = 'directionalLight'
      directionalLight.position.set(9, 13, 80)
      scene.add(directionalLight)

      directionalLight2 = new THREE.DirectionalLight(0xffffff, 1)
      directionalLight2.name = 'directionalLight2'
      directionalLight2.position.set(2, 8, -550)
      // scene.add(directionalLight2)
      // 环境光
      // ambient = new THREE.AmbientLight(0x72b1ff);
      ambient = new THREE.AmbientLight(0xffffff, 2.5)
      ambient.name = 'ambient'
      scene.add(ambient)

      // var texture_bg = new THREE.TextureLoader().load('./assets/background/nx.jpg');
      // scene.background = texture_bg
      //天空盒
      var path = "./assets/background/"; //设置路径
      var directions = ["posx", "negx", "posy", "negy", "posz", "negz"]; //获取对象
      var format = ".jpg"; //格式
      // //创建盒子，并设置盒子的大小为( 5000, 5000, 5000 )
      var skyGeometry = new THREE.BoxGeometry(500, 500, 500);
      // //设置盒子材质
      var materialArray = [];
      for (var i = 0; i < 6; i++)
        materialArray.push(new THREE.MeshBasicMaterial({
          map: THREE.ImageUtils.loadTexture(path + directions[i] + format), //将图片纹理贴上
          side: THREE.BackSide /*镜像翻转，如果设置镜像翻转，那么只会看到黑漆漆的一片，因为你身处在盒子的内部，所以一定要设置镜像翻转。*/
        }));
      var skyMaterial = new THREE.MeshFaceMaterial(materialArray);
      var skyBox = new THREE.Mesh(skyGeometry, skyMaterial); //创建一个完整的天空盒，填入几何模型和材质的参数
      scene.add(skyBox); //在场景中加入天空盒

      //非交互模型加载

      /**
       * OBJ和材质文件mtl加载
       */
      // var OBJLoader = new THREE.OBJLoader();//obj加载器
      // var MTLLoader = new THREE.MTLLoader();//材质文件加载器
      // MTLLoader.load('./assets/obj/number.mtl', function(materials) {
      //   // 返回一个包含材质的对象MaterialCreator
      //   console.log(materials);
      //   //obj的模型会和MaterialCreator包含的材质对应起来
      //   OBJLoader.setMaterials(materials);
      //   OBJLoader.load('./assets/obj/number.obj', function(obj) {
      //     console.log(obj);
      //     // obj.scale.set(10, 10, 10); //放大obj组对象
      //     scene.add(obj);//返回的组对象插入场景中
      //   })
      // })

      var gltfLoader = new THREE.GLTFLoader();
      var dracoLoader = new THREE.DRACOLoader();
      // draco文件路径
      dracoLoader.setDecoderPath('./js/Draco/')
      dracoLoader.setDecoderConfig({ type: 'js' })
      dracoLoader.preload()
      gltfLoader.setDRACOLoader(dracoLoader)
      // gltfLoader.load('./assets/new_gltf/yizitestDraco.gltf', function (gltf) {
      //   console.log(gltf)
      //   scene.add(gltf.scene)
      // })

      // dracotest_Loader = new THREE.GLTFLoader()
      // dracotest_Loader.load('./assets/new_gltf/yizitestDraco.gltf', function (obj) {
      //   //道路及大楼
      //   // objAll = obj
      //   console.log(obj)
      //   obj.scene.name = 'test'
      //   scene.add(obj.scene)
      // })

      // dracoLoader.load('./assets/new_gltf/内部建模/yizitestDraco.gltf', function (geometry) {
      //   console.log(geometry)
      // })

      // var dracoLoader = new THREE.GLTFLoader()
      // dracoLoader.setDRACOLoader(new THREE.DRACOLoader());

      // dracoLoader.load('./assets/new_gltf/内部建模/yizitestDraco.gltf', function(gltf) {
      //   console.log('load_draco')
      //   scene.add(gltf.scene)
      // })

      GLTFLoader_AllBuild = new THREE.GLTFLoader()
      GLTFLoader_AllBuild.setDRACOLoader(dracoLoader)
      GLTFLoader_AllBuild.load('./assets/inside_gltf/main_buildDraco.gltf', function (obj) {
        obj.scene.name = 'all'
        scene.add(obj.scene)
      })

      // GLTFLoader_AllBuild = new THREE.GLTFLoader()
      // GLTFLoader_AllBuild.load('./assets/new_gltf/main_build.gltf', function (obj) {
      //   //道路及大楼
      //   // objAll = obj
      //   obj.scene.name = 'all'
      //   scene.add(obj.scene)
      // })
      GLTFLoader_Ground = new THREE.GLTFLoader()
      GLTFLoader_Ground.setDRACOLoader(dracoLoader)
      GLTFLoader_Ground.load('./assets/inside_gltf/groundDraco.gltf', function (obj) {
        obj.scene.name = 'ground'
        obj.scene.children[0].traverse(function (obj) {
          if (obj.isMesh) {
            obj.material.color.set(0x000000)
            obj.material.emissive.set(0x001435)
          }
        })
        scene.add(obj.scene)
      })


      // GLTFLoader_Ground.load('./assets/new_gltf/ground.gltf', function (obj) {
      //   //道路及大楼
      //   obj.scene.name = 'ground'
      //   scene.add(obj.scene)
      //   // let ground_obj = scene.getObjectByName('ground')
      //   obj.scene.children[0].traverse(function (obj) {
      //     if (obj.isMesh) {
      //       obj.material.color.set(0x000000)
      //       obj.material.emissive.set(0x001435)
      //     }
      //   })
      // })
      GLTFLoader_Road = new THREE.GLTFLoader()
      GLTFLoader_Road.setDRACOLoader(dracoLoader)
      GLTFLoader_Road.load('./assets/inside_gltf/roadDraco.gltf', function (obj) {
        obj.scene.name = 'road'
        scene.add(obj.scene)
        obj.scene.traverse(function (obj) {
          if (obj.isMesh) {
            obj.material.color.set(0x17FFFF)
            obj.material.emissive.set(0x28E4FF)
          }
        })
      })


      // GLTFLoader_AllBuild = new THREE.GLTFLoader()
      // GLTFLoader_AllBuild.load('./assets/new_gltf/road.gltf', function (obj) {
      //   //道路及大楼
      //   // objAll = obj
      //   obj.scene.name = 'road'
      //   scene.add(obj.scene)
      //   obj.scene.traverse(function (obj) {
      //     if (obj.isMesh) {
      //       obj.material.color.set(0x17FFFF)
      //       obj.material.emissive.set(0x28E4FF)
      //     }
      //   })
      // })

      //加载过程，可以显示进度值
      // var onProgress = function (xhr) {
      //   if (xhr.lengthComputable) {
      //     var percentComplete = xhr.loaded / xhr.total * 100;
      //     console.log(Math.round(percentComplete, 2) + '% downloaded');
      //     document.getElementById('progress').innerText = Math.round(percentComplete, 2) + '%下载';
      //   }
      // };
      // //错误回调，因为网页调试有报错，这里可以不做处理
      // var onError = function (xhr) {
      // };
      //回调写好了，现在可以用加载的方法加载模型了。
      // GLTFLoader_otherBuild.load('./assets/new_gltf/other.gltf', onLoad, onProgress, onError);

      GLTFLoader_otherBuild = new THREE.GLTFLoader()
      GLTFLoader_otherBuild.setDRACOLoader(dracoLoader)
      GLTFLoader_otherBuild.load('./assets/inside_gltf/otherDraco.gltf', function (obj) {
        //道路及大楼
        // objAll = obj
        // console.log(obj) 
        obj.scene.name = 'other'
        scene.add(obj.scene)

        obj.scene.traverse(function (obj) {
          if (obj.isMesh) {
            obj.material.metalness = 0.2
            obj.material.roughness = 0.36
            obj.material.color.set(0x00091C)
            obj.material.emissive.set(0x000000)
          }
        })
      },
        function (xhr) {
          if (xhr.lengthComputable) {
            var percentComplete = xhr.loaded / xhr.total * 100;
            console.log(Math.round(percentComplete, 2) + '% downloaded');
            document.getElementById('progress').innerText = '数据加载中...';
            if (percentComplete == 100) {
              // $('#progress').hide()
              document.getElementById('progress').innerText = '';
            }
          }
        })

      // var texture = new THREE.TextureLoader().load("./assets/imgs/texture_map.jpg");
      // texture.wrapS = THREE.RepeatWrapping;//RepeatWrapping
      // texture.wrapT = THREE.RepeatWrapping;
      // texture.repeat.set(4, 2);
      // var loader = new THREE.ImageLoader(manager);
      // loader.load('http://renyuan.bos.xyz/FloorsCheckerboard_S_Diffuse.jpg', function (image) {
      //   texture.image = image;
      //   texture.needsUpdate = true;
      // });
      // var texture = new THREE.TextureLoader().load('http://renyuan.bos.xyz/FloorsCheckerboard_S_Diffuse.jpg', function () {
      //   renderer.render(scene, camera)
      // })
      // // 加载一个资源
      // var material = new THREE.MeshStandardMaterial({
      //   emissive: 0x5A5A5A,
      //   map: texture
      //   // repeat.set(1, 1)
      // });

      // GLTFLoader_Floor1 = new THREE.GLTFLoader();
      // GLTFLoader_Floor1.load('./assets/new_gltf/内部建模/1楼/1楼地面.gltf', function (obj) { //第一层楼
      //   model_floor1 = obj.scene
      //   scene.add(obj.scene)
      //   obj.scene.traverse(function (child) {
      //     if (child instanceof THREE.Mesh) {
      //       // child.material.map = texture
      //       child.material = material
      //       // child.material.emissive = {r: 70, g: 70, b: 70}
      //     }
      //   })
      //   obj.scene.name = "1floor"
      //   model_floor1.visible = false
      // })

      // var texture2 = new THREE.TextureLoader().load("./assets/imgs/qian1.jpg");
      // var material2 = new THREE.MeshStandardMaterial({
      //   // emissive: 0x464646,
      //   map: texture2
      //   // repeat.set(1, 1)
      // });


      GLTFLoader_Floor1 = new THREE.GLTFLoader();
      GLTFLoader_Floor1.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor1.load('./assets/inside_gltf/1floor/房间Draco.gltf', function (obj) {
        model_floor1 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "1floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              n.material.emissive.set(0xaaaaaa)
            });
          }
          else if (child.name == "空白1") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor1.visible = false
      })


      GLTFLoader_Floor2 = new THREE.GLTFLoader();
      GLTFLoader_Floor2.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor2.load('./assets/inside_gltf/2floor/房间Draco.gltf', function (obj) {
        model_floor2 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "2floor"
        obj.scene.traverse(function (child) {
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              n.material.emissive.set(0xaaaaaa)
            });
          }
          else if (child.name == "空白1") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor2.visible = false
      })

      GLTFLoader_Floor3 = new THREE.GLTFLoader();
      GLTFLoader_Floor3.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor3.load('./assets/inside_gltf/3floor/房间Draco.gltf', function (obj) {
        model_floor3 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "3floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              n.material.emissive.set(0xaaaaaa)
            });
          }
          else if (child.name == "空白1") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor3.visible = false
      })

      GLTFLoader_Floor4 = new THREE.GLTFLoader();
      GLTFLoader_Floor4.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor4.load('./assets/inside_gltf/4floor/房间Draco.gltf', function (obj) {
        model_floor4 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "4floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              n.material.emissive.set(0xaaaaaa)
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor4.visible = false
      })

      GLTFLoader_Floor5 = new THREE.GLTFLoader();
      GLTFLoader_Floor5.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor5.load('./assets/inside_gltf/5floor/房间Draco.gltf', function (obj) {
        model_floor5 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "5floor"
        obj.scene.traverse(function (child) {
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              n.material.emissive.set(0xaaaaaa)
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor5.visible = false
      })

      GLTFLoader_Floor6 = new THREE.GLTFLoader();
      GLTFLoader_Floor6.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor6.load('./assets/inside_gltf/6floor/房间Draco.gltf', function (obj) {
        model_floor6 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "6floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0xaaaaaa)
              }
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor6.visible = false
      })

      GLTFLoader_Floor7 = new THREE.GLTFLoader();
      GLTFLoader_Floor7.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor7.load('./assets/inside_gltf/7floor/房间Draco.gltf', function (obj) {
        model_floor7 = obj.scene
        scene.add(obj.scene)
        console.log(obj)
        obj.scene.name = "7floor"
        obj.scene.traverse(function (child) {
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0xaaaaaa)
              }
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor7.visible = false
      })


      GLTFLoader_Floor8 = new THREE.GLTFLoader();
      GLTFLoader_Floor8.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor8.load('./assets/inside_gltf/8floor/房间Draco.gltf', function (obj) {
        model_floor8 = obj.scene
        scene.add(obj.scene)
        console.log(obj)
        obj.scene.name = "8floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0xaaaaaa)
              }
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor8.visible = false
      })

      GLTFLoader_Floor9 = new THREE.GLTFLoader();
      GLTFLoader_Floor9.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor9.load('./assets/inside_gltf/9floor/房间Draco.gltf', function (obj) {
        model_floor9 = obj.scene
        scene.add(obj.scene)
        obj.scene.name = "9floor"
        obj.scene.traverse(function (child) {
          // console.log(child)
          if (child.name == "地面") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0xaaaaaa)
              }
            });
          }
          else if (child.name == "墙") { // && child instanceof THREE.Mesh
            child.children.map(function (n) {
              if (n instanceof THREE.Mesh) {
                n.material.emissive.set(0x333333)
              }
            });
          }
        })
        model_floor9.visible = false
      },
        function (xhr) {
          if (xhr.lengthComputable) {
            var percentComplete = xhr.loaded / xhr.total * 100;
            console.log(Math.round(percentComplete, 2) + '% downloaded');
            document.getElementById('progress').innerText = "数据加载中" + Math.round(percentComplete, 2) + '%' + "  最低要求4核8G以上配置运行此系统";
            if (percentComplete == 100) {
              setTimeout(() => {
                $('#progress').hide()
              }, 3000);
            }
          }
        })

      $('#back_all').hide()
      //隐藏左侧部分元素
      $('#video_list').hide()
      $('#waterTank_list').hide()
      $('#smoke_list').hide()
      $('#gate_list').hide()
      $('#AOCN_list').hide()
      $('#meter_list').hide()
    }

    // 点击隐藏
    // var moonDiv = document.createElement('div');
    // moonDiv.className = 'label';
    // moonDiv.textContent = '点击折叠';
    // let bodyDom = document.body;
    // bodyDom.insertBefore(moonDiv, bodyDom.lastChild);

    let model_all_num = {}
    let model_all_model = {}
    model_all_num['model_all_floor' + 1] = []
    model_all_num['model_all_floor' + 2] = []
    model_all_num['model_all_floor' + 3] = []
    model_all_num['model_all_floor' + 4] = []
    model_all_num['model_all_floor' + 5] = []
    model_all_num['model_all_floor' + 6] = []
    model_all_num['model_all_floor' + 7] = []
    model_all_num['model_all_floor' + 8] = []
    model_all_num['model_all_floor' + 9] = []
    model_all_model['model_all_floor' + 1] = []
    model_all_model['model_all_floor' + 2] = []
    model_all_model['model_all_floor' + 3] = []
    model_all_model['model_all_floor' + 4] = []
    model_all_model['model_all_floor' + 5] = []
    model_all_model['model_all_floor' + 6] = []
    model_all_model['model_all_floor' + 7] = []
    model_all_model['model_all_floor' + 8] = []
    model_all_model['model_all_floor' + 9] = []

    let tween1,
      tween2,
      tween3,
      tween4,
      tween5,
      tween6,
      tween7,
      tween8,
      tween9,
      tween10,
      tween_camera,
      tween_smoke,
      tween_target

    function fold_all() {
      if (model_floor1.position.y != -120) {
        return
      } else {
        tween1.reversed(!tween1.reversed())
        tween2.reversed(!tween2.reversed())
        tween3.reversed(!tween3.reversed())
        tween4.reversed(!tween4.reversed())
        tween5.reversed(!tween5.reversed())
        tween6.reversed(!tween6.reversed())
        tween7.reversed(!tween7.reversed())
        tween8.reversed(!tween8.reversed())
        tween9.reversed(!tween9.reversed())
        // tween10.reversed(!tween10.reversed())
      }
    }

    $('#fold_floor').on('click', function () {
      fold_all()
    })

    var test = 'model_video'
    let model_position


    function load1otherModel() {
      GLTFLoader_Floor1_other = new THREE.GLTFLoader();
      GLTFLoader_Floor1_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor1_other.load('./assets/inside_gltf/1floor/所有设施Draco.gltf', function (obj) {
        model_other1 = obj.scene
        obj.scene.name = '1other'
        scene.add(obj.scene)
        model_other1.visible = false
      })
    }
    function load2otherModel() {
      GLTFLoader_Floor2_other = new THREE.GLTFLoader();
      GLTFLoader_Floor2_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor2_other.load('./assets/inside_gltf/2floor/所有设施Draco.gltf', function (obj) {
        model_other2 = obj.scene
        obj.scene.name = '2other'
        scene.add(obj.scene)
        model_other2.visible = false
      })
    }
    function load3otherModel() {
      GLTFLoader_Floor3_other = new THREE.GLTFLoader();
      GLTFLoader_Floor3_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor3_other.load('./assets/inside_gltf/3floor/所有设施Draco.gltf', function (obj) {
        model_other3 = obj.scene
        obj.scene.name = '3other'
        scene.add(obj.scene)
        model_other3.visible = false
      })
    }
    function load4otherModel() {
      GLTFLoader_Floor4_other = new THREE.GLTFLoader();
      GLTFLoader_Floor4_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor4_other.load('./assets/inside_gltf/4floor/所有设施Draco.gltf', function (obj) {
        model_other4 = obj.scene
        obj.scene.name = '4other'
        scene.add(obj.scene)
        model_other4.visible = false
      })
    }
    function load5otherModel() {
      GLTFLoader_Floor5_other = new THREE.GLTFLoader();
      GLTFLoader_Floor5_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor5_other.load('./assets/inside_gltf/5floor/所有设施Draco.gltf', function (obj) {
        model_other5 = obj.scene
        obj.scene.name = '5other'
        scene.add(obj.scene)
        model_other5.visible = false
      })
    }
    function load6otherModel() {
      GLTFLoader_Floor6_other = new THREE.GLTFLoader();
      GLTFLoader_Floor6_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor6_other.load('./assets/inside_gltf/6floor/所有设施Draco.gltf', function (obj) {
        model_other6 = obj.scene
        obj.scene.name = '6other'
        scene.add(obj.scene)
        model_other6.visible = false
      })
    }
    function load7otherModel() {
      GLTFLoader_Floor7_other = new THREE.GLTFLoader();
      GLTFLoader_Floor7_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor7_other.load('./assets/inside_gltf/7floor/所有设施Draco.gltf', function (obj) {
        model_other7 = obj.scene
        obj.scene.name = '7other'
        scene.add(obj.scene)
        model_other7.visible = false
      })
    }
    function load8otherModel() {
      GLTFLoader_Floor8_other = new THREE.GLTFLoader();
      GLTFLoader_Floor8_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor8_other.load('./assets/inside_gltf/8floor/所有设施Draco.gltf', function (obj) {
        model_other8 = obj.scene
        obj.scene.name = '8other'
        scene.add(obj.scene)
        model_other8.visible = false
      })
    }
    function load9otherModel() {
      GLTFLoader_Floor9_other = new THREE.GLTFLoader();
      GLTFLoader_Floor9_other.setDRACOLoader(dracoLoader)
      GLTFLoader_Floor9_other.load('./assets/inside_gltf/9floor/所有设施Draco.gltf', function (obj) {
        model_other9 = obj.scene
        obj.scene.name = '9other'
        scene.add(obj.scene)
        model_other9.visible = false
      },
        function (xhr) {
          if (xhr.lengthComputable) {
            var percentComplete = xhr.loaded / xhr.total * 100;
            console.log(Math.round(percentComplete, 2) + '% downloaded');
            if (percentComplete == 100) {
              $('#bottomFloor').show()
            }
          }
        })
    }
    //隐藏模型
    function hiddenObject(obj) {
      let selectedObject = scene.getObjectByName(obj)
      // console.log(selectedObject)
      if (selectedObject) {
        selectedObject.visible = false
      }
    }
    //显示模型
    function showObject(obj) {
      let selectedObject = scene.getObjectByName(obj)
      // console.log(selectedObject)
      if (selectedObject) {
        selectedObject.visible = true
      }
    }
    //移除模型
    function removeEntity(object) {
      let selectedObject = scene.getObjectByName(object)
      scene.remove(selectedObject)
    }

    //遍历所有模型
    function modelTraverse() {
      for (let i = 0; i < scene.children.length; i++) {
        model_all.push(scene.children[i])
      }
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight //相机视锥体的长宽比
      camera.updateProjectionMatrix() //更新相机投影矩阵

      renderer.setSize(window.innerWidth, window.innerHeight) //渲染器大小
    }

    function draw() {
      init()
      //1楼模型
      loadModel('./assets/inside_gltf/设备/a栋闸机.gltf', 'gate1', 1, 'hide', 0.2, 0, 0.001)
      loadModel('./assets/inside_gltf/设备/b栋闸机.gltf', 'gate2', 1, 'hide')
      // loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f1_1', 1, 'hide', 0.1, 0.001, -0.15)
      // loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f1_2', 1, 'hide', 3.4, 0.001, -0.14)
      // loadVideo('video_f1_1', 1, 'hide', 0.75, 0, 1)
      // loadVideo('video_f1_2', 1, 'hide', -1.5, 0, 1)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f1_1', 1, 'hide', 0.482, -0.007, -0.894)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f1_2', 1, 'hide', 2.519, -0.008, -0.895)
      //二楼模型
      loadModel('./assets/inside_gltf/设备/水表.gltf', 'meter_f2_1', 2, 'hide', 2.478, 0.646, 0.107)
      loadModel('./assets/inside_gltf/设备/水表.gltf', 'meter_f2_1', 2, 'hide', 2.478, 0.600, -0.964)
      loadModel('./assets/inside_gltf/设备/水表.gltf', 'meter_f2_1', 2, 'hide', 2.478, 0.600, -1.481)

      //三楼模型
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_1', 3, 'hide', 3.327, 1.33, 1.671)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_2', 3, 'hide', 3.322, 1.33, 1.163)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_3', 3, 'hide', 3.326, 1.332, 0.551)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_4', 3, 'hide', 3.245, 1.333, -0.076)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_5', 3, 'hide', 2.958, 1.300, 1.976)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_6', 3, 'hide', 2.959, 1.300, 1.976)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_7', 3, 'hide', 2.957, 1.300, 0.952)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_8', 3, 'hide', 2.969, 1.300, -0.161)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_9', 3, 'hide', 2.559, 1.333, 1.864)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_10', 3, 'hide', 2.507, 1.333, 0.812)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_11', 3, 'hide', 2.632, 1.333, 0.244)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_12', 3, 'hide', 2.586, 1.333, -0.131)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_13', 3, 'hide', 0.042, 1.333, 1.668)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_14', 3, 'hide', -0.003, 1.333, 0.818)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_15', 3, 'hide', 0.041, 1.333, 0.261)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_16', 3, 'hide', 0.026, 1.333, -0.156)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_17', 3, 'hide', -0.365, 1.333, 1.939)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_18', 3, 'hide', -0.364, 1.332, 1.225)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_19', 3, 'hide', -0.363, 1.331, 0.421)
      loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f3_20', 3, 'hide', -0.382, 1.330, -0.300)

      loadModel('./assets/inside_gltf/设备/空开.gltf', 'aocn_f3_1', 3, 'hide', 2.115, 1.377, -0.66)

      //六楼模型
      loadModel('./assets/inside_gltf/设备/水表.gltf', 'meter_f6_1', 6, 'hide', 2.040, 3.233, -0.325)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_1', 6, 'hide', -0.282, 3.244, -1.459)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_2', 6, 'hide', -0.283, 3.245, -1.098)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_3', 6, 'hide', -0.284, 3.243, -0.642)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_4', 6, 'hide', -0.285, 3.244, -0.340)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_5', 6, 'hide', -0.047, 3.251, -0.905)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_6', 6, 'hide', 0.355, 3.249, -0.905)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_7', 6, 'hide', 2.531, 3.260, -0.906)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_8', 6, 'hide', 2.883, 3.271, -0.905)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_9', 6, 'hide', 3.041, 3.270, -1.268)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_10', 6, 'hide', 3.040, 3.272, -1.515)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_11', 6, 'hide', 3.041, 3.266, -0.548)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f6_12', 6, 'hide', 3.037, 3.256, -0.289)

      //八楼模型
      // loadDraco('./assets/inside_gltf/4楼/所有设施Draco.gltf', '4facility', 'hide')
      loadModel('./assets/inside_gltf/设备/空开.gltf', 'aocn_f8_2', 8, 'hide', 2.970, 4.520, -0.076)
      loadModel('./assets/inside_gltf/设备/空开.gltf', 'aocn_f8_3', 8, 'hide', 2.975, 4.557, -0.791)
      loadModel('./assets/inside_gltf/设备/空开.gltf', 'aocn_f8_4', 8, 'hide', -0.333, 4.596, -0.512)

      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_1', 8, 'hide', 3.037, 4.555, -1.368)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_2', 8, 'hide', 3.056, 4.556, -1.043)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_3', 8, 'hide', 3.054, 4.556, -0.783)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_4', 8, 'hide', 3.055, 4.554, -0.480)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_5', 8, 'hide', 2.872, 4.556, -0.926)
      loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f8_6', 8, 'hide', 2.596, 4.550, -0.925)
      //九楼模型
      loadModel('./assets/inside_gltf/设备/空开.gltf', 'aocn_f9_1', 9, 'hide', 0.104, 5.249, -1.200)
      loadModel('./assets/inside_gltf/设备/水表.gltf', 'meter_f9_1', 9, 'hide', 3.309, 5.184, 1.093)
      loadModel('./assets/inside_gltf/设备/水箱.gltf', 'tank_f9', 9, 'hide', -3.402, -1.363, -0.974)

      // loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f9_1', 9, 'hide', 1.32, 5.18, 1.9)
      // loadModel('./assets/inside_gltf/设备/摄像头.gltf', 'video_f9_2', 9, 'hide', 1.32, 5.18, 0.55)
      // loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f9_1', 9, 'hide', 0, 5.18, -0.1)
      // loadModel('./assets/inside_gltf/设备/烟感.gltf', 'smoke_f9_2', 9, 'hide', 0, 5.18, -2.14)

      // initStats() //加载性能监视
      animate()
      //创建摄像头icon
      createIcon('video_f1_1', 'videoIcon', 'f1')
      createIcon('video_f1_2', 'videoIcon', 'f1')
      createIcon('video_f6_1', 'videoIcon', 'f6')
      createIcon('video_f6_2', 'videoIcon', 'f6')
      createIcon('video_f6_3', 'videoIcon', 'f6')
      createIcon('video_f6_4', 'videoIcon', 'f6')
      createIcon('video_f6_5', 'videoIcon', 'f6')
      createIcon('video_f6_6', 'videoIcon', 'f6')
      createIcon('video_f6_7', 'videoIcon', 'f6')
      createIcon('video_f6_8', 'videoIcon', 'f6')
      createIcon('video_f6_9', 'videoIcon', 'f6')
      createIcon('video_f6_10', 'videoIcon', 'f6')
      createIcon('video_f6_11', 'videoIcon', 'f6')
      createIcon('video_f6_12', 'videoIcon', 'f6')
      createIcon('video_f8_1', 'videoIcon', 'f8')
      createIcon('video_f8_2', 'videoIcon', 'f8')
      createIcon('video_f8_3', 'videoIcon', 'f8')
      createIcon('video_f8_4', 'videoIcon', 'f8')
      createIcon('video_f8_5', 'videoIcon', 'f8')
      createIcon('video_f8_6', 'videoIcon', 'f8')
      createIcon('video_f8_7', 'videoIcon', 'f8')
      createIcon('video_f8_8', 'videoIcon', 'f8')
      //创建水箱icon
      createIcon('tank_f9', 'waterIcon', 'f9')
      //创建闸机icon
      createIcon('gate1', 'gateIcon', 'f1')
      createIcon('gate2', 'gateIcon', 'f1')
      // createIcon('smoke_f1_1', 'smokeIcon', 'f1')
      // createIcon('smoke_f1_2', 'smokeIcon', 'f1')
      createIcon('smoke_f3_1', 'smokeIcon', 'f3')
      createIcon('smoke_f3_2', 'smokeIcon', 'f3')
      createIcon('smoke_f3_3', 'smokeIcon', 'f3')
      createIcon('smoke_f3_4', 'smokeIcon', 'f3')
      createIcon('smoke_f3_5', 'smokeIcon', 'f3')
      createIcon('smoke_f3_6', 'smokeIcon', 'f3')
      createIcon('smoke_f3_7', 'smokeIcon', 'f3')
      createIcon('smoke_f3_8', 'smokeIcon', 'f3')
      createIcon('smoke_f3_9', 'smokeIcon', 'f3')
      createIcon('smoke_f3_10', 'smokeIcon', 'f3')
      createIcon('smoke_f3_11', 'smokeIcon', 'f3')
      createIcon('smoke_f3_12', 'smokeIcon', 'f3')
      createIcon('smoke_f3_13', 'smokeIcon', 'f3')
      createIcon('smoke_f3_14', 'smokeIcon', 'f3')
      createIcon('smoke_f3_15', 'smokeIcon', 'f3')
      createIcon('smoke_f3_16', 'smokeIcon', 'f3')
      createIcon('smoke_f3_17', 'smokeIcon', 'f3')
      createIcon('smoke_f3_18', 'smokeIcon', 'f3')
      createIcon('smoke_f3_19', 'smokeIcon', 'f3')
      createIcon('smoke_f3_20', 'smokeIcon', 'f3')
      //创建弹窗
      create_video_Layer('video_f1_1_ly', 'videoLayer')
      create_video_Layer('video_f1_2_ly', 'videoLayer')
      create_video_Layer('video_f6_1_ly', 'videoLayer')
      create_video_Layer('video_f6_2_ly', 'videoLayer')
      create_video_Layer('video_f6_3_ly', 'videoLayer')
      create_video_Layer('video_f6_4_ly', 'videoLayer')
      create_video_Layer('video_f6_5_ly', 'videoLayer')
      create_video_Layer('video_f6_6_ly', 'videoLayer')
      create_video_Layer('video_f6_7_ly', 'videoLayer')
      create_video_Layer('video_f6_8_ly', 'videoLayer')
      create_video_Layer('video_f6_9_ly', 'videoLayer')
      create_video_Layer('video_f6_10_ly', 'videoLayer')
      create_video_Layer('video_f6_11_ly', 'videoLayer')
      create_video_Layer('video_f6_12_ly', 'videoLayer')
      create_video_Layer('video_f9_1_ly', 'videoLayer')
      create_video_Layer('video_f9_2_ly', 'videoLayer')
      create_video_Layer('video_f9_3_ly', 'videoLayer')
      create_video_Layer('video_f9_4_ly', 'videoLayer')
      create_video_Layer('video_f9_5_ly', 'videoLayer')
      create_video_Layer('video_f9_6_ly', 'videoLayer')
      //创建水箱弹窗
      createLayer('tank_f9_ly', 'tankLayer')
      //创建烟感弹窗
      createLayer('smoke_f3_1_ly', 'smokeLayer')
      createLayer('smoke_f3_2_ly', 'smokeLayer')
      createLayer('smoke_f3_3_ly', 'smokeLayer')
      createLayer('smoke_f3_4_ly', 'smokeLayer')
      createLayer('smoke_f3_5_ly', 'smokeLayer')
      createLayer('smoke_f3_6_ly', 'smokeLayer')
      createLayer('smoke_f3_7_ly', 'smokeLayer')
      createLayer('smoke_f3_8_ly', 'smokeLayer')
      createLayer('smoke_f3_9_ly', 'smokeLayer')
      createLayer('smoke_f3_10_ly', 'smokeLayer')
      createLayer('smoke_f3_11_ly', 'smokeLayer')
      createLayer('smoke_f3_12_ly', 'smokeLayer')
      createLayer('smoke_f3_13_ly', 'smokeLayer')
      createLayer('smoke_f3_14_ly', 'smokeLayer')
      createLayer('smoke_f3_15_ly', 'smokeLayer')
      createLayer('smoke_f3_16_ly', 'smokeLayer')
      createLayer('smoke_f3_17_ly', 'smokeLayer')
      createLayer('smoke_f3_18_ly', 'smokeLayer')
      createLayer('smoke_f3_19_ly', 'smokeLayer')
      createLayer('smoke_f3_20_ly', 'smokeLayer')
      // createLayer('video_f1_2_ly', 'videoLayer')
      // createLayer('video3_ly', 'videoLayer')
      // createLayer('video4_ly', 'videoLayer')
      // createLayer('gate1_ly', 'gateLayer')
      // createLayer('gate2_ly', 'gateLayer')
      // createLayer('smoke1_ly', 'smokeLayer')
      // createLayer('smoke2_ly', 'smokeLayer')
      // createLayer('smoke3_ly', 'smokeLayer')

      layer_show('videoIcon')
      layer_show('waterIcon')
      layer_show('smokeIcon')
      layer_show('gateIcon')
    }

    //进入大楼
    $('#in_ex_floor').on('click', function () {
      $('#back_all').show()
      //显示左侧部分元素
      $('#video_list').show()
      $('#waterTank_list').show()
      $('#smoke_list').show()
      $('#gate_list').show()
      $('#AOCN_list').show()
      $('#meter_list').show()

      hiddenObject('all')
      hiddenObject('other')
      hiddenObject('ground')
      hiddenObject('road')

      removeEntity('directionalLight')
      directionalLight = new THREE.DirectionalLight(0xffffff, 1)
      directionalLight.position.set(5, 1.601, 57.199)
      directionalLight.name = 'directionalLight'
      scene.add(directionalLight)

      // scene.add(directionalLight2)
      // removeEntity('directionalLight2')
      removeEntity('ambient')
      ambient = new THREE.AmbientLight(0xD7EAFF, 0.5)
      ambient.name = 'ambient'
      scene.add(ambient)
      scene.add(point)

      showObject('1floor')
      showObject('2floor')
      showObject('3floor')
      showObject('4floor')
      showObject('5floor')
      showObject('6floor')
      showObject('7floor')
      showObject('8floor')
      showObject('9floor')

      // showObject('1other')
      // showObject('2other')
      // showObject('3other')
      // showObject('4other')
      // showObject('5other')
      // showObject('6other')
      // showObject('7other')
      // showObject('8other')
      // showObject('9other')

      tween_camera = TweenMax.to(camera.position, 2, {
        x: 4.39,
        y: 5.08,
        z: 14.63,
        ease: Expo.easeInOut, //Linear.easeNone  Cubic.easeIn
        //Power3.easeOut
      })
      tween_target = TweenMax.to(controls.target, 2, {
        x: -0.4,
        y: -6.49,
        z: -9.06
      })
      load1otherModel()
      load2otherModel()
      load3otherModel()
      load4otherModel()
      load5otherModel()
      load6otherModel()
      load7otherModel()
      load8otherModel()
      load9otherModel()

      // if (model_floor1.position.y != 0) {
      //   return
      // } else {
      //   //增加每层模型
      //   model_all_num['model_all_floor' + 1].push(model_floor1.position)
      //   model_all_num['model_all_floor' + 2].push(model_floor2.position)
      //   model_all_num['model_all_floor' + 3].push(model_floor3.position)
      //   model_all_num['model_all_floor' + 4].push(model_floor4.position)
      //   model_all_num['model_all_floor' + 5].push(model_floor5.position)
      //   model_all_num['model_all_floor' + 6].push(model_floor6.position)
      //   model_all_num['model_all_floor' + 7].push(model_floor7.position)
      //   model_all_num['model_all_floor' + 8].push(model_floor8.position)
      //   model_all_num['model_all_floor' + 9].push(model_floor9.position)

      //   // model_all_floorB1.push(model_floorB1.position)

      //   tween1 = TweenMax.to(model_all_num['model_all_floor' + 1], 2, {
      //     y: -120,
      //     ease: Power3.easeOut, //Linear.easeNone
      //   })
      //   tween2 = TweenMax.to(model_all_num['model_all_floor' + 2], 2, {
      //     y: -90,
      //     ease: Power3.easeOut,
      //   })
      //   tween3 = TweenMax.to(model_all_num['model_all_floor' + 3], 2, {
      //     y: -60,
      //     ease: Power3.easeOut,
      //   })
      //   tween4 = TweenMax.to(model_all_num['model_all_floor' + 4], 2, {
      //     y: -30,
      //     ease: Power3.easeOut,
      //   })
      //   tween5 = TweenMax.to(model_all_num['model_all_floor' + 5], 2, {
      //     y: 0,
      //     ease: Power3.easeOut,
      //   })
      //   tween6 = TweenMax.to(model_all_num['model_all_floor' + 6], 2, {
      //     y: 30,
      //     ease: Power3.easeOut,
      //   })
      //   tween7 = TweenMax.to(model_all_num['model_all_floor' + 7], 2, {
      //     y: 60,
      //     ease: Power3.easeOut,
      //   })
      //   tween8 = TweenMax.to(model_all_num['model_all_floor' + 8], 2, {
      //     y: 90,
      //     ease: Power3.easeOut,
      //   })
      //   tween9 = TweenMax.to(model_all_num['model_all_floor' + 9], 2, {
      //     y: 120,
      //     ease: Power3.easeOut,
      //   })

      // modelTraverse()
      // tween_smoke = TweenMax.to()

      // moveFloor()

      // tween1.play()
      // tween2.play()
      // tween3.play()
      // tween4.play()
      // tween5.play()
      // tween6.play()
      // tween7.play()
      // tween8.play()
      // tween9.play()
      // tween10.play()
      // }

      $('#in_ex_floor').hide()
    })

    //添加ICON的dom
    function createIcon(mesh_id, class_name, icon_floor) {
      let iconDiv = document.createElement('div')
      iconDiv.className = 'Icon'
      iconDiv.classList.add(class_name)
      iconDiv.classList.add(icon_floor)
      iconDiv.id = mesh_id
      let bodyDom = document.body
      bodyDom.insertBefore(iconDiv, bodyDom.lastChild)
      let iconDivid = $('#' + mesh_id)
      return iconDivid
    }
    //添加弹窗dom
    function createLayer(mesh_id, class_name) {
      let iconDiv = document.createElement('div')
      iconDiv.className = 'Layer'
      iconDiv.classList.add(class_name)
      iconDiv.id = mesh_id
      let bodyDom = document.body
      bodyDom.insertBefore(iconDiv, bodyDom.lastChild)
      let layerDivid = $('#' + mesh_id)
      return layerDivid
    }

    function create_video_Layer(mesh_id, class_name) {
      let iconDiv = document.createElement('div')
      iconDiv.className = 'Layer'
      iconDiv.classList.add(class_name)
      iconDiv.id = mesh_id
      let videoDiv = `<video class="video-js vjs-default-skin" controls preload="auto" muted data-setup='{}'
        style='width: 100%;height: 100%'></video>;`
      // videoDiv.attr('id', mesh_id + '_video')
      let bodyDom = document.body
      bodyDom.insertBefore(iconDiv, bodyDom.lastChild)
      let layerDivid = $('#' + mesh_id)
      layerDivid.html(videoDiv)
      layerDivid.children("video").attr('id', mesh_id + '_video')
      return layerDivid
    }

    function renderDiv() {
      let testDiv = $('.testDiv')
      let groupNames = [
        'video_f1_1',
        'video_f1_2',
        'video_f6_1',
        'video_f6_2',
        'video_f6_3',
        'video_f6_4',
        'video_f6_5',
        'video_f6_6',
        'video_f6_7',
        'video_f6_8',
        'video_f6_9',
        'video_f6_10',
        'video_f6_11',
        'video_f6_12',
        'video_f8_1',
        'video_f8_2',
        'video_f8_3',
        'video_f8_4',
        'video_f8_5',
        'video_f8_6',
        'tank_f9',
        // 'video3',
        // 'video4',
        'gate1',
        'gate2',
        // 'smoke_f1_1',
        // 'smoke_f1_2',
        'smoke_f3_1',
        'smoke_f3_2',
        'smoke_f3_3',
        'smoke_f3_4',
        'smoke_f3_5',
        'smoke_f3_6',
        'smoke_f3_7',
        'smoke_f3_8',
        'smoke_f3_9',
        'smoke_f3_10',
        'smoke_f3_11',
        'smoke_f3_12',
        'smoke_f3_13',
        'smoke_f3_14',
        'smoke_f3_15',
        'smoke_f3_16',
        'smoke_f3_17',
        'smoke_f3_18',
        'smoke_f3_19',
        'smoke_f3_20'
      ]
      let halfWidth = window.innerWidth / 2
      let halfHeight = window.innerHeight / 2

      let xOffset = -8
      let yOffset = -35
      for (let i = 0; i < groupNames.length; i++) {
        let groupName = groupNames[i]
        let group = scene.getObjectByName(groupName)
        if (group) {
          let mesh
          group.traverse(function (child) {
            if (child.isMesh) {
              mesh = child
            }
          })

          let vector = new THREE.Vector3()
          mesh.getWorldPosition(vector)
          vector.project(camera)
          //图标位置
          $('#' + groupName).css({
            left: vector.x * halfWidth + halfWidth + xOffset,
            top: -vector.y * halfHeight + halfHeight + yOffset,
          })
          //弹框位置
          $('#' + groupName + '_ly').css({
            left: vector.x * halfWidth + halfWidth + 2,
            top: -vector.y * halfHeight + halfHeight + -142,
          })

          let g = testDiv.data('group')
          if (g === groupName) {
            $('.testDiv')
              .text(groupName)
              .css({
                left: vector.x * halfWidth + halfWidth + 10,
                top: -vector.y * halfHeight + halfHeight + 10,
              })
          }
        }
      }
    }

    function animate() {
      // stats.update()
      controls.update()
      renderer.render(scene, camera)
      requestAnimationFrame(animate)
      renderDiv()
    }

    function loadModel(path, gltf_name, floor_num, visible, pst_x, pst_y, pst_z, rotateX) {
      new THREE.GLTFLoader().load(path, function (gltf) {
        gltf.scene.name = gltf_name //set模型名字
        if (pst_x, pst_y, pst_z) {
          gltf.scene.position.set(pst_x, pst_y, pst_z) //set模型位置
        }

        if (visible == 'hide') {
          gltf.scene.visible = false
        }

        if (rotateX == 180) {
          gltf.scene.rotateX(Math.PI / 2)
        } else if (rotateX == 90) {
          gltf.scene.rotateX(Math.PI / 4)
        }

        model_all_num['model_all_floor' + floor_num].push(gltf.scene.position) //添加模型所在楼层位置
        model_all_model['model_all_floor' + floor_num].push(gltf.scene)

        // model.position.set(0, 60, 0);
        // let sc = 3;
        model = gltf.scene.children[0]
        model.traverse(function (child) {
          //对模型体内的每个几何体进行遍历
          if (child.isMesh) {
            child.castShadow = true //允许模型本身对自己产生阴影
            child.receiveShadow = true //接受阴影渲染
            // child.scale.set(sc, sc, sc); //模型重置比例放大。

            Vplace1.push(child)
          }
        })

        scene.add(gltf.scene)
      })
    }

    document.addEventListener(
      'click',
      function () {
        ray(Vplace1)
      },
      false,
    )

    function getGroup(groupName, mesh) {
      let { parent } = mesh
      while (parent) {
        if (parent.isGroup && parent.name === groupName) {
          return parent
        }

        parent = parent.parent
      }
    }

    function ray(Bplace) {
      // var Sx = event.clientX; //鼠标单击位置横坐标
      // var Sy = event.clientY; //鼠标单击位置纵坐标

      // //屏幕坐标转标准设备坐标
      // var x = (Sx / window.innerWidth) * 2 - 1; //标准设备横坐标
      // var y = -(Sy / window.innerHeight) * 2 + 1; //标准设备纵坐标
      // var standardVector = new THREE.Vector3(x, y, 0.5); //标准设备坐标

      // //标准设备坐标转世界坐标
      // var worldVector = standardVector.unproject(camera);

      //射线投射方向单位向量(worldVector坐标减相机位置坐标)
      // var ray = worldVector.sub(camera.position).normalize();
      //创建射线投射器对象
      // var raycaster = new THREE.Raycaster(camera.position, ray);
      //方法2
      let x = event.clientX
      let y = event.clientY
      let mouse = new THREE.Vector2()

      mouse.x = (x / window.innerWidth) * 2 - 1
      mouse.y = -(y / window.innerHeight) * 2 + 1

      var raycaster = new THREE.Raycaster()
      raycaster.setFromCamera(mouse, camera)

      //返回射线选中的对象
      var intersects = raycaster.intersectObjects(Bplace) //Bplace为需要被点击的目标体池集合

      if (intersects.length > 0) {
        console.log('拾取到了')

        let obj = intersects[0].object

        let groupNames = ['video1', 'video2', 'video3', 'video4']
        for (let i = 0; i < groupNames.length; i++) {
          let groupName = groupNames[i]
          let group = scene.getObjectByName(groupName)

          if (getGroup(groupName, obj)) {
            let child = scene.getObjectByName(groupName)
            child.traverse(function (obj) {
              if (obj.isMesh) {
                obj.material.color.set(0xff0000)
              }
            })

            $('#' + groupName).show()
            $('.testDiv').data('group', groupName)
          }
        }
      }
    }
    //返回主场景
    $('#back_all').on('click', function () {
      back_to_home()
      $('#bottomFloor').hide()
    })

    function back_to_home() {
      // fold_all()
      let selectedObject = scene.getObjectByName('all')
      // setTimeout(function () {
      selectedObject.visible = true
      // }, 1000)
      showObject('ground')
      showObject('road')
      showObject('other')

      hiddenObject('1floor')
      hiddenObject('2floor')
      hiddenObject('3floor')
      hiddenObject('4floor')
      hiddenObject('5floor')
      hiddenObject('6floor')
      hiddenObject('7floor')
      hiddenObject('8floor')
      hiddenObject('9floor')

      hiddenObject('1floor')
      hiddenObject('2floor')
      hiddenObject('3floor')
      hiddenObject('4other')
      hiddenObject('5other')
      hiddenObject('6other')
      hiddenObject('7other')
      hiddenObject('8other')
      hiddenObject('9other')


      // $('.videoIcon').hide()
      // $('.gateIcon').hide()
      $('.Icon').hide()
      $('.Layer').hide()

      if ((selectedObject.visible = true)) {
        $('#back_all').hide()
      }
      tween_camera = TweenMax.to(camera.position, 2, {
        x: 13.6,
        y: 10,
        z: 31.3,
        ease: Expo.easeInOut, //Linear.easeNone  Cubic.easeIn
      })

      $('#video_list').removeClass('video_list_in')
      $('#gate_list').removeClass('gate_list_in')

      //隐藏左侧部分元素
      $('#video_list').hide()
      $('#waterTank_list').hide()
      $('#smoke_list').hide()
      $('#gate_list').hide()
      $('#AOCN_list').hide()
      $('#meter_list').hide()
      //显示进入大楼
      $('#in_ex_floor').show()
    }

    $('#camera_position').on('click', function () {
      console.log(camera.position)
      console.log(controls.target)
    })


  </script>
</body>

</html>